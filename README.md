# CRC.ORF.project

Processing ...

Will be ready soon

### 1. Ribo-seq Data Processing

The cryptic ORFs were predicted based on Ribo-TISH pipeline.

STEP 1: The ribosome-protected RNA fragments (RPF) reads were trimmed and the low-quality reads were filtered by Sickle (http://github.com/ucdavis-bioinformatics/sickle).

STEP 2: The RPF reads after filtering were mapped to human rRNA sequences using bowtie and allowing for two mismatches.

STEP 3: The reads which were not mapped to human rRNA sequences, were then mapped to the human genome (GRCh38) with transcriptome annotations GENECODE v22, NCBI refseq, MiTranscriptome and lincRNA transcript annotations generated by Dr. John Rinn’s group, using STAR (v.2.6.1b) with parameters `“--outFilterMismatchNmax 2 –outFilterIntronMotifs RemoveNoncanonicalUnannotated --alignIntronMax 20000 --outMultimapperOrder Random --outSAMmultNmax 1 --alignEndsType EndToEnd”`.

STEP 4: Quality control was performed using Ribo-TISH quality module with all the uniquely mapped RPF reads in the annotated ORFs. The RPFs were grouped by their lengths and each aligned RPF read was represented by its 5′ end before estimation of the P-site offset. The metagene RPF count profile near the start/stop codon was constructed by summing the RPF count between −40 and +20 bp of the first base of the start/stop codon across all annotated protein-coding genes. The P-site offset was estimated based on the distribution of the 5′ end of the metagene RPF counts near the annotated start codons. The RPF count between the 15 bp upstream of the first base of the start codon and the 12 bp upstream of the first base of the stop codon were used to calculate the RPF count distributions across three reading frames. The fraction of the RPF counts in the dominant frame (fd) was calculated as the ratio between the maximum RPF count among all three reading frames and the sum of the RPF counts from all reading frames.

STEP 5: The cryptic ORFs were predicted with Ribo-TISH predict module with regular riboseq data longest mode.

STEP 6: The same ORFs in different ribo-seq libraries and different transcript isoforms were merged together.


### 2. Screen Library Design

The sgRNAs targeting the cryptic ORFs which were predicted from ribo-seq data, were designed using the Sequence Scan for CRISPR (SSC). The designed sgRNAs that meet one of the following criteria: a, being mapped to multiple genomic regions; b, with any Ns or more than three consecutive T; c, with high level of GC content (>60%); d, guide efficiency score< 0.2; e, being mapped to the annotated CDSs, were filtered out from the library.

The 636 sgRNAs targeting 106 core essential genes were included as positive controls, and the 1,064 sgRNAs that target AAVS1 sites in the human genome or do not target the human genome were included as negative controls, respectively.


### 3. Screen Data Processing & Analysis

MAGeCK (v0.5.9.4) was used to calculate the read count of individual sgRNAs in different samples with the following parameters: `mageck count -l hct116.sgrna.library --control-sgrna hct116.sgrna.library.negctrl --norm-method control -n hct116.sgrna.count --sample-label D0,D21 --fastq files.fq`.

DESeq2 was used to identify the differentially expressed sgRNAs between D0 and D21. The read counts were normalized by the mapped negative control sgRNAs using ratio median normalization, and the normalization factors were applied to all sgRNAs. The cryptic ORFs with at least 2 significantly depleted sgRNAs (`log2Fold-Change < -log2(1.5) and p < 0.05`).


### 4. RNA-seq Data Processing & Analysis

STEP 1: Trim for adaptor sequence and mask for low-complexity and low-quality sequence

STEP 2: Map to the human genome (GRCh38) and GENCODE V22 transcriptome

STAR (v.2.6.1b) with the parameters: “--outSAMunmapped Within --outFilterType BySJout --twopassMode Basic --outSAMtype BAM SortedByCoordinate”.

STEP 3: Expression Read Count

The gene-level raw read-counts were calculated using htseq-count function of HTSeq (0.11.0), based on the aligned and sorted bam files.

STEP 4: Normalization & Differential Expression Analysis

The normalization of read counts and differential gene expression analysis were performed, using DESeq2 (1.22.2). The filters of

`basemean >= 1 && |log2Fold-Change| >= log2(1.5) && FDR <= 0.05`   

were used to define differentially expressed genes for downstream analysis.


### 5. ChIP-seq Data Processing & Analysis

STEP 1: Reads QC and Trim Adaptor
ChIP-seq reads were first trimmed by Trim Galore (v0.6.5) (https://www.bioinformatics.babraham.ac.uk/projects/trim_galore/), a wrapper around two tools: cutadapt v2.8 (https://github.com/marcelm/cutadapt/) and FastQC v0.11.5 (https://github.com/chgibb/FastQC0.11.5/; https://www.bioinformatics.babraham.ac.uk/projects/fastqc/).
STEP 2: Mapping
Reads were then mapped to the human genome (GRCh38), using Bowtie2 (v2.4.1). The resulting sorted BAM files were converted into bedGraph and bigWig formats using BEDTools (v2.24.0) and UCSC bedGraphToBigWig (v4).
STEP 3: PEAK Calling
The ChIP-seq peaks were identified by MACS2 (v2.1.2) with the parameters `macs2 callpeak -t ChIP.bam -c INPUT.bam -g hs --outdir output -n NAME 2> NAME.callpeak.log`. BETA (v1.0.7) was used to annotate the peaks that are associated with genes of interest (FDR <= 0.05).


### 6. TCGA Expression & Clinical Data Correlation Analysis

TCGA and GTEx RNA-seq data joint analysis was performed based on the combined cohort: TCGA TARGET GTEx, from UCSC Toil RNA-seq Recompute Normalized gene expression in TPM and clinical information were extracted with customized script, for the differential gene expression analysis between tumor and tissues, and among different cancer types. The Wilcoxon Rank Sum Test was used to identify the genes with deregulated expression between tumors and the corresponding normal tissues.


### 7. Functional Annotation & Gene Functional Enrichment Analysis

The gene ontology enrichment analysis was performed in DAVID.

